{"name":"Zimbra Content Pak","description":"Grok patterns, Beat Input, and Stream for zimbra","category":"Grok, Inputs, Stream","inputs":[{"id":"5a90d35e687cf800cf991a7e","title":"Zimbra-Logs","configuration":{"recv_buffer_size":1048576,"port":5045,"tls_key_file":"","tls_enable":false,"tls_key_password":"","tcp_keepalive":false,"tls_client_auth_cert_file":"","tls_client_auth":"disabled","override_source":null,"bind_address":"0.0.0.0","tls_cert_file":""},"static_fields":{},"type":"org.graylog.plugins.beats.BeatsInput","global":false,"extractors":[{"title":"ZimbraPOSTFIXSMTPRELAYGENERAL","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPRELAYGENERAL}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXSMTPDTLSCONNECT","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPDTLSCONNECT}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXSMTPDCONNECT","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPDCONNECT}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXSMTPDDISCONNECT","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPDDISCONNECT}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXSMTPDACTIONS","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPDACTIONS}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXSMTPDTIMEOUTS","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPDTIMEOUTS}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXSMTPDSETQIDWITHSASL","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPDSETQIDWITHSASL}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXSMTPDSETQID ","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPDSETQID}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXSMTPDLOGINFAILED","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXSMTPDLOGINFAILED}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXCLEANUP","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXCLEANUP}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraPOSTFIXQMGR","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{POSTFIXQMGR}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraSASLRESULT","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{SASLRESULT}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraAMAVISRESULT","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{AMAVISRESULT}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraZMMAILBOX","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{ZMMAILBOX}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraNGINXACCESS","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{NGINXACCESS}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"ZimbraZMAUDIT","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{ZMAUDIT}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0}]}],"streams":[{"id":"5a947d17687cf8095f8f36d6","title":"Zimbra","description":"Zimbra Mail Logs","disabled":false,"matching_type":"OR","stream_rules":[{"type":"EXACT","field":"type","value":"postfix","inverted":false,"description":""},{"type":"EXACT","field":"type","value":"nginx","inverted":false,"description":""},{"type":"EXACT","field":"type","value":"zimbra_mailbox","inverted":false,"description":""},{"type":"EXACT","field":"type","value":"zimbra_audit","inverted":false,"description":""}],"outputs":[],"default_stream":false}],"outputs":[],"dashboards":[],"grok_patterns":[{"name":"OPENDKIM","pattern":"%{TIMESTAMP_ISO8601:created_at} %{SYSLOGHOST:hostname} %{OPENDKIM_COMP} %{QUEUEID}: %{DATA:comment} '%{EMAILADDRESS:email}'"},{"name":"EMAILLOCALPART","pattern":"[a-zA-Z][a-zA-Z0-9_.+-=:]+"},{"name":"MAILBOX_COMMAND","pattern":"(\\(batch\\) )?%{WORD:command}( %{WORD:item_type}(:)? )?"},{"name":"POSTFIXQMGR","pattern":"%{QUEUEID:qid}: (?:removed|from=<(?:%{FROMEMAILADDRESS:from})?>(?:, size=%{POSINT:size}, nrcpt=%{POSINT:nrcpt} \\(%{GREEDYDATA:queuestatus}\\))?)"},{"name":"ZMQTP","pattern":"\\[qtp%{NUMBER:qtp_process}-%{DATA:qtp_thread}:%{DATA:qtp_info}\\]"},{"name":"EMAILADDRESS","pattern":"%{EMAILLOCALPART}@%{HOSTNAME}"},{"name":"COMPID","pattern":"%{COMP:process}\\/%{COMP:component}(?:\\[%{POSINT:pid}\\])?"},{"name":"COMP","pattern":"([\\w._\\/%-]+)"},{"name":"QUEUEID","pattern":"(?:[a-zA-Z0-9]+|NOQUEUE)"},{"name":"POSTFIX","pattern":"%{TIMESTAMP_ISO8601:created_at} %{SYSLOGHOST:hostname} %{COMPID}:"},{"name":"EMAILADDRESS","pattern":"%{EMAILADDRESSPART}@%{EMAILADDRESSPART}"},{"name":"SALSRESULT","pattern":"%{EMAILADDRESS:username} auth %{SASLSTATUS:result}(: authentication failed for %{SASLEMAIL})?"},{"name":"EMAILADDRESSPART","pattern":"[a-zA-Z0-9_.+-=:]+"},{"name":"POSTFIXBOUNCE","pattern":"%{QUEUEID:qid}: sender non-delivery notification: %{QUEUEID:bouncequeueid}"},{"name":"POSTFIXSMTP5XX","pattern":"%{QUEUEID:qid}: to=<%{TOEMAILADDRESS:to}>,(?:\\sorig_to=<%{TOEMAILADDRESS:orig_to}>,)? relay=%{DSTRELAY}, delay=%{POSREAL:delay}, delays=%{DELAYS:delays}, dsn=%{DSN:dsn}, status=%{STATUS:result} \\(host %{HOSTNAME}\\[%{IP}\\] said: %{PERMERROR:responsecode} %{DATA:smtp_response} \\(in reply to %{DATA:command} command\\)\\)"},{"name":"AMAVISRESULT","pattern":"%{AMAVISSTATUS:status} %{DATA:result} (\\(%{DATA:result_summary}\\) )?\\{%{DATA:actions}\\},( %{AMAVISORGCON})? <(?:%{FROMEMAILADDRESS:from})?> -> %{DATA:to}(, quarantine: %{DATA:quarantine})?(, Queue-ID: %{QUEUEID:qid})?(, Message-ID: <%{DATA:messageid}>)?(, mail_id: %{DATA:mail_id})?(, Hits: %{DATA:hits})?(, size: %{NONNEGINT:size:int})?(, queued_as: %{QUEUEID:queued_as})?(, dkim_sd=%{DATA:dkim_sd})?, %{NONNEGINT:delay} ms"},{"name":"ADDING_MESSAGE_OP","pattern":"id=%{NUMBER:item_id},)? (Message-ID=<%{DATA:messageid}>,)? (parentId=%{NUMBER:parent_id},)? (folderId=%{NUMBER:folder_id},)? (folderName=%{DATA:folder_name}$"},{"name":"AMAVIS_DKIM","pattern":"FWD from <(?:%{FROMEMAILADDRESS:from})?> -> %{DATA:to},( BODY=%{DATA:amavis_body})? 250 2.0.0 from MTA\\(smtp:%{RELAYIPPORT}:%{NONNEGINT:relay_port}\\): 250 2.0.0 Ok: queued as %{QUEUEID:queued_as}"},{"name":"POSTFIXSMTPLOSTCONNECTION","pattern":"%{QUEUEID:qid}: lost connection with %{DSTRELAY} while %{GREEDYDATA:reason}"},{"name":"COMMAND_EXTRA","pattern":"( %{GREEDYDATA:command_params})? (%{NUMBER:elapsed}ms)?"},{"name":"POSTFIXSMTPREFUSAL","pattern":"%{QUEUEID:qid}: host %{DSTRELAY} refused to talk to me: %{GREEDYDATA:reason}"},{"name":"DELETING_MESSAGE_OP","pattern":"(\\(id=%{NUMBER:item_id}\\))?\\.$"},{"name":"POSTFIXPOSTSUPER","pattern":"%{QUEUEID:qid}: %{GREEDYDATA:action}"},{"name":"MOVING_MESSAGE_OP","pattern":"\\(id=%{NUMBER:item_id}\\) to Folder %{DATA:folder_name} \\(id=%{NUMBER:folder_id}\\)"},{"name":"POSTFIXSMTPTIMEOUT","pattern":"%{QUEUEID:qid}: conversation with %{DSTRELAY} timed out while %{GREEDYDATA:reason}"},{"name":"POSTFIXSMTPDTLSCONNECT","pattern":"TLS connection established from %{SRCRELAY}: %{GREEDYDATA:tls_info}"},{"name":"ZMTHREAD","pattern":"%{NONNEGINT:thread}"},{"name":"NGINXACCESS","pattern":"%{IPORHOST:clientip}:%{POSINT:port} %{NGUSER:ident} %{NGUSER:username} \\[%{HTTPDATE:created_at}\\]  \"%{WORD:verb} %{URIPATHPARAM:request} HTTP/%{NUMBER:httpversion}\" %{NUMBER:http_code} (?:%{NUMBER:bytes:int}|-) (?:\"(?:%{URI:referrer}|-)\"|%{QS:referrer}) %{QS:agent}"},{"name":"NGUSER","pattern":"%{DATA}"},{"name":"POSTFIXSMTP4XX","pattern":"%{QUEUEID:qid}: host %{DSTRELAY} said: %{GREEDYDATA:reason}"},{"name":"ELAPSED","pattern":"elapsed=%{NUMBER:elapsed}"},{"name":"POSTFIXSMTPCONNECT","pattern":"connect to %{DSTRELAY}: %{GREEDYDATA:reason}"},{"name":"AMAVIS_CHECKING","pattern":"Checking: %{DATA:amavis_mail_id} %{DATA:amavis_src_net} %{RELAYIPPORT} <(?:%{FROMEMAILADDRESS:from})?> -> %{GREEDYDATA:to}"},{"name":"AMAVIS_FILECHECK","pattern":"ESMTP:%{RELAYIPPORT}:%{NONNEGINT:relay_port} %{DATA:quarantine_file}: <(?:%{FROMEMAILADDRESS:from})?> -> %{DATA:to}( SIZE=%{POSINT:size})? Received: %{GREEDYDATA:summary}"},{"name":"DSTRELAY","pattern":"(?:%{HOSTNAME:dst_relayhost}(?:\\[%{IP:dst_relayip}\\](?::[0-9]+(.[0-9]+)?)?)?)"},{"name":"SRCRELAY","pattern":"(?:%{HOSTNAME:src_relayhost}(?:\\[%{IP:src_relayip}\\](?::[0-9]+(.[0-9]+)?)?)?)"},{"name":"POSREAL","pattern":"[0-9]+(.[0-9]+)?"},{"name":"CLIENT","pattern":"(?:%{HOSTNAME:clienthost}(?:\\[%{IP:clientip}\\](?::[0-9]+(.[0-9]+)?)?)?)"},{"name":"DSN","pattern":"%{NONNEGINT}.%{NONNEGINT}.%{NONNEGINT}"},{"name":"DELAYS","pattern":"(%{POSREAL}[/]*)+"},{"name":"POSTFIXSMTPDCONNECT","pattern":"connect from %{SRCRELAY}"},{"name":"POSTFIXSMTPDACTIONS","pattern":"%{QUEUEID:qid}: %{POSTFIXACTION:action}: %{DATA:command} from %{SRCRELAY}: %{DATA:smtp_response}: %{DATA:reason}; from=<%{FROMEMAILADDRESS:from}> to=<%{TOEMAILADDRESS:to}> proto=%{DATA:proto} helo=<%{IPORHOST}>"},{"name":"ZMPROCESS","pattern":"%{DATA:zm_process}"},{"name":"POSTFIXSMTPDDISCONNECT","pattern":"disconnect from %{SRCRELAY}"},{"name":"POSTFIXSMTPDSETQIDWITHSASL","pattern":"%{QUEUEID:qid}: client=%{CLIENT}, sasl_method=%{DATA:saslmethod}, sasl_username=%{GREEDYDATA:username}"},{"name":"ZMUSERAGENT","pattern":"%{DATA:user_agent}(/| - )%{DATA:user_agent_ver}"},{"name":"POSTFIXSMTPDTIMEOUTS","pattern":"timeout after %{DATA:command} from %{SRCRELAY}"},{"name":"ZMPROGRAM","pattern":"\\[%{ZMPROCESS}(-%{ZMTHREAD})?(:%{DATA:program_info})?\\]"},{"name":"POSTFIXSMTPDLOGINFAILED","pattern":"warning: %{CLIENT}: SASL LOGIN authentication failed: authentication failure"},{"name":"ZMCOMMAND","pattern":"cmd=%{WORD:command}"},{"name":"POSTFIXSMTPDSETQID","pattern":"%{QUEUEID:qid}: client=%{CLIENT}$"},{"name":"ZMCLIENT","pattern":"\\[(name=%{DATA:username};)?(mid=%{NUMBER:mid};)?(ip=%{IPORHOST:src_ip};)?(DeviceID=%{DATA:device};)?(oip=%{IPORHOST:clientip}(, %{IPORHOST:clientip})?;)?(via=%{DATA:via};)?(ua=%{ZMUSERAGENT};)?\\]"},{"name":"POSTFIXCLEANUP","pattern":"%{QUEUEID:qid}: message-id=(<)?%{DATA:messageid}(>)?$"},{"name":"ZMAUDIT","pattern":"%{TIMESTAMP_ISO8601:created_at} %{ZMLOGLEVEL}  %{ZMPROGRAM} %{ZMCLIENT} security - %{ZMCOMMAND}; ( %{ZMCOMMAND_PARAMS})?"},{"name":"POSTFIXSMTPDCLIENT","pattern":"%{QUEUEID:qid}: client=%{SRCRELAY:client}$"},{"name":"ZMCOMMAND_PARAMS","pattern":"(%{WORD:username_type}=%{DATA:username}(; protocol=%{WORD:protocol})?(; error=%{DATA:error})?(; feature=%{WORD:feature})?(; member=%{DATA:member})?(; status=%{WORD:status})?;)?"},{"name":"ZMLOGLEVEL","pattern":"%{WORD:level}"},{"name":"TOEMAILADDRESS","pattern":"%{EMAILADDRESSPART}@%{EMAILADDRESSPART:to_domain}"},{"name":"FROMEMAILADDRESS","pattern":"%{EMAILADDRESSPART}@%{EMAILADDRESSPART:from_domain}"},{"name":"RELAY","pattern":"(?:%{HOSTNAME:relayhost}(?:\\[%{IP:relayip}\\](?::[0-9]+(.[0-9]+)?)?)?)"},{"name":"SASL_COM","pattern":"saslauthd(?:\\[%{POSINT:pid}\\])?: %{DATA:provider}:"},{"name":"SASLEMAIL","pattern":"(?:\\[%{EMAILADDRESS:email}\\])"},{"name":"SASLSTATUS","pattern":"(?:failed|OK)"},{"name":"SASLAUTHD","pattern":"%{TIMESTAMP_ISO8601:created_at} %{SYSLOGHOST:hostname} %{SASL_COM}"},{"name":"AMAVIS_COMP","pattern":"amavis(?:\\[%{POSINT:pid}\\])?: %{AMAVIS_THREAD}"},{"name":"PERMERROR","pattern":"5[0-9]{2}"},{"name":"ZBOX_SUBJECT","pattern":"%{QUEUEID:qid}: info: header Subject:( )?%{DATA:subject} from %{SRCRELAY}; from=<%{FROMEMAILADDRESS:from}> to=<%{TOEMAILADDRESS:to}> %{DATA}: ZBOX_SUBJECT$"},{"name":"AMAVIS_THREAD","pattern":"\\(%{DATA:thread}\\)"},{"name":"STATUS","pattern":"sent|deferred|bounced|expired"},{"name":"ZBOX_ATTACHMENT","pattern":"%{QUEUEID:qid}: info: header Content-Disposition: %{DATA:content_disposition};(%{DATA})filename=%{DATA:attachment} from %{SRCRELAY}; from=<(%{FROMEMAILADDRESS:from})?> to=<(%{TOEMAILADDRESS:to})?> %{DATA}: ZBOX_ATTACHMENT$"},{"name":"AMAVISSTATUS","pattern":"(?:Passed|Blocked)"},{"name":"POSTFIXACTION","pattern":"discard|dunno|filter|hold|ignore|info|prepend|redirect|replace|reject|warn"},{"name":"MESSAGELEVEL","pattern":"reject|warning|error|fatal|panic"},{"name":"AMAVISORGCON","pattern":"(?:%{AMAVISORGEXT}|%{AMAVISORGINT})"},{"name":"OPENDKIM_COMMENT","pattern":"%{DATA:comment}"},{"name":"POSTFIXSMTPRELAY","pattern":"%{QUEUEID:qid}: to=<%{TOEMAILADDRESS:to}>,(?:\\sorig_to=<%{TOEMAILADDRESS:orig_to}>,)? relay=%{DSTRELAY},( conn_use=%{NUMBER:conn_use},)? delay=%{POSREAL:delay}, delays=%{DELAYS:delays}, dsn=%{DSN:dsn}, status=%{WORD:result}( \\(%{GREEDYDATA:result_comment}\\))?"},{"name":"AMAVISORGINT","pattern":"ORIGINATING_POST \\[127.0.0.1\\]"},{"name":"OPENDKIM_COMP","pattern":"opendkim(?:\\[%{POSINT:pid}\\])?:"},{"name":"RELAYIPPORT","pattern":"(?:\\[%{IP:relayip}\\])"},{"name":"ZMMAILBOX","pattern":"%{TIMESTAMP_ISO8601:created_at} %{ZMLOGLEVEL} ( )?(%{ZMQTP}|%{ZMPROGRAM}) %{ZMCLIENT} %{DATA:protocol} - %{MAILBOX_COMMAND}((%{ADDING_MESSAGE_OP})?(%{MOVING_MESSAGE_OP})?(%{DELETING_MESSAGE_OP})?)?( elapsed=%{NUMBER:elapsed})?"},{"name":"AMAVISORGEXT","pattern":"%{DATA}(\\/%{DATA:src_net})? %{RELAYIPPORT:local_ip}:%{NONNEGINT:relay_port}( %{RELAYIPPORT:remote_ip})?"},{"name":"POSTFIXSMTPRELAY_TO_DKIM","pattern":"%{POSTFIXSMTPRELAY} \\(%{DATA:reason}: queued as %{QUEUEID:queued_as}\\)"},{"name":"AMAVIS","pattern":"%{TIMESTAMP_ISO8601:created_at} %{SYSLOGHOST:hostname} %{AMAVIS_COMP}"},{"name":"POSTFIXSMTPRELAYGENERAL","pattern":"%{POSTFIXSMTPRELAY} \\(%{DATA:reason}\\)$"}],"lookup_tables":[],"lookup_caches":[],"lookup_data_adapters":[]}